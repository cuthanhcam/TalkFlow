@model TalkFlow.Models.StrangerModel
@{
    ViewData["Title"] = "Stranger";
}
@section customHead {
    <link rel="stylesheet" href="~/css/stranger_index.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bbbootstrap/libraries@main/choices.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
          rel="stylesheet">
}
<div class="min-vh-100 d-flex align-items-center justify-content-center flex-column w-100 animated-bg">
    <div class="card-modern particle-glow p-5 text-center" style="max-width:550px; width: 95%; animation: fadeInUp 0.6s ease-out;">
        <style>
            @@keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        </style>
        <div class="mb-4" style="animation: fadeInUp 0.6s ease-out 0.2s both;">
            <img class="img-fluid" id="homepage_logo" src="~/asset/image/logo.png" alt="logo" style="max-height: 70px; margin-bottom: 1.5rem;">
            <h2 class="mb-3" style="background: linear-gradient(135deg, #6366f1, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 700;">
                Tell Us About Yourself
            </h2>
            <p class="text-muted mb-4">Help us find the perfect match for you</p>
        </div>
        <form id="stranger_index_form" style="width:100%; animation: fadeInUp 0.6s ease-out 0.4s both;" method="post" action="@Url.Action("FindOut", "Stranger")" data-validate="true">
            <div class="mb-3">
                <label class="form-label text-white text-start d-block mb-2" style="font-weight: 500;">
                    <i class="fas fa-user me-2"></i>Display Name
                </label>
                <input placeholder="e.g., Anonymous User" required name="DisplayName" type="text" class="form-control form-control-modern" maxlength="50" style="font-size: 1rem; padding: 0.875rem 1rem;">
            </div>

            <div class="mb-3 d-flex gap-2">
                <div style="width: 50%;">
                    <label class="form-label text-white text-start d-block mb-2" style="font-weight: 500; font-size: 0.875rem;">
                        <i class="fas fa-venus-mars me-2"></i>Gender
                    </label>
                    <select class="select-t form-control form-control-modern" id="select_gender" name="Gender" required style="width: 100%; padding: 0.875rem 1rem;">
                        <option value="" selected disabled>Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Others">Others</option>
                    </select>
                </div>
                <div style="width: 50%;">
                    <label class="form-label text-white text-start d-block mb-2" style="font-weight: 500; font-size: 0.875rem;">
                        <i class="fas fa-birthday-cake me-2"></i>Age
                    </label>
                    <input placeholder="e.g., 25" class="form-control form-control-modern" type="number" required name="Age" min="13" max="100" style="font-size: 1rem; padding: 0.875rem 1rem;" />
                </div>
            </div>


            <div class="mb-4">
                <label class="form-label text-white text-start d-block mb-2" style="font-weight: 500;">
                    <i class="fas fa-globe-americas me-2"></i>Country
                </label>
                <select id="select_country" name="Nationality" required class="form-control form-control-modern" style="padding: 0.875rem 1rem;">
                    <option value="" disabled selected>Select your country</option>
                </select>
            </div>
            
            <div class="d-grid">
                <button type="button" class="btn btn-modern-primary btn-lg" onclick="submitForm()" style="position: relative; overflow: hidden;">
                    <span style="position: relative; z-index: 1;">
                        <i class="fas fa-arrow-right me-2"></i>Next
                    </span>
                    <span style="position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transform: translateX(-100%); animation: shimmer 2s infinite;"></span>
                </button>
            </div>
        </form>
    </div>
</div>

@section script {
    <script src="https://cdn.jsdelivr.net/gh/bbbootstrap/libraries@main/choices.min.js"></script>
    <script src="~/js/stranger_index.js" asp-append-version="true"></script>
    <script>
        $.ajax({
            url: "https://gist.githubusercontent.com/ssskip/5a94bfcd2835bf1dea52/raw/3b2e5355eb49336f0c6bc0060c05d927c2d1e004/ISO3166-1.alpha2.json",
            type: "get",
            success: function (data) {
                var countries = JSON.parse(data);
                var select = document.getElementById("select_country");
                Object.keys(countries).forEach(key => {
                    var el = document.createElement("option");
                    el.textContent = countries[key];
                    el.value = key;
                    select.appendChild(el);
                })
            }
        }).then(function () {
            $('.select-t').each(function () {
                var $this = $(this), selectOptions = $(this).children('option').length;

                $this.addClass('hide-select');
                $this.wrap('<div class="select p-4"></div>');
                $this.after('<div class="custom-select"></div>');

                var $customSelect = $this.next('div.custom-select');
                $customSelect.text($this.children('option').eq(0).text());

                var $optionlist = $('<ul />', {
                    'class': 'select-options'
                }).insertAfter($customSelect);

                for (var i = 0; i < selectOptions; i++) {
                    $('<li />', {
                        text: $this.children('option').eq(i).text(),
                        rel: $this.children('option').eq(i).val()
                    }).appendTo($optionlist);
                }

                var $optionlistItems = $optionlist.children('li');

                $customSelect.click(function (e) {
                    e.stopPropagation();
                    $('div.custom-select.active').not(this).each(function () {
                        $(this).removeClass('active').next('ul.select-options').hide();
                    });
                    $(this).toggleClass('active').next('ul.select-options').slideToggle();
                });

                $optionlistItems.click(function (e) {
                    e.stopPropagation();
                    $customSelect.text($(this).text()).removeClass('active');
                    $this.val($(this).attr('rel'));
                    $optionlist.hide();
                });

                $(document).click(function () {
                    $customSelect.removeClass('active');
                    $optionlist.hide();
                });

            });
            var multipleCancelButton = new Choices('#select_country', {
                removeItemButton: true,
                maxItemCount: 1,
                searchResultLimit: 5,
                renderChoiceLimit: 5,
                placeholderValue: 'Your country',
                noChoicesText: 'No country found',
                searchPlaceholderValue: 'Select your country',

            });

        },
            function () {/*I fail*/ })

        function submitForm() {
            var form = document.getElementById("stranger_index_form");
            form.submit();
        }
    </script>
}